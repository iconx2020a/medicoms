This contains key management code
